<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>API Console</title>
  <link rel="stylesheet" href="../webjars/api-console/3.0.17/dist/styles/api-console-light-theme.css" type="text/css" />
</head>
<body ng-cloak class="raml-console-body">
  <script type="text/javascript" src="../webjars/api-console/3.0.17/dist/scripts/api-console-vendor.js"></script>
  <script type="text/javascript" src="../webjars/api-console/3.0.17/dist/scripts/api-console.js"></script>
  <script type="text/javascript">
    $.noConflict();

    var currentProtocol = window.location.protocol,
        baseUrl = currentProtocol + '//' + window.location.host,
        setProtocols = function (resource) {
          var i;

          if (resource.resources) {
            for (i = 0; i < resource.resources.length; i += 1) {
              setProtocols(resource.resources[i]);
            }
          }

          if (resource.methods) {
            for (i = 0; i < resource.methods.length; i += 1) {
              resource.methods[i].protocols = [currentProtocol];
            }
          }
        };

    angular.module('raml').config(function($provide) {
      $provide.decorator('ramlParser', function($delegate) {
        var originalMethod = $delegate.loadPath;

        $delegate.loadPath = function() {
          return originalMethod.apply($delegate, arguments).then(function (raml) {
            var i;

            raml.specification.baseUri = baseUrl;

            if (raml.specification.resources) {
              for (i = 0; i < raml.specification.resources.length; i += 1) {
                setProtocols(raml.specification.resources[i]);
              }
            }

            return raml;
          });
        };

        return $delegate;
      });
    });

    angular.element(function() {
      angular.bootstrap(document, ['ramlConsoleApp']);
    });
  </script>
  <raml-console-loader
          src="api-definition.raml"
          options="{disableThemeSwitcher: true, disableRamlClientGenerator: true, singleView: true}">
  </raml-console-loader>
</body>
</html>
